include ':app'
import groovy.json.JsonSlurper

def flutterProjectRoot = rootProject.projectDir.parentFile.toPath()

File pluginsFile = new File(flutterProjectRoot.toFile(), '.flutter-plugins.json')
def object = new JsonSlurper().parseText(pluginsFile.text)
assert object instanceof Map
assert object.plugins instanceof Map
assert object.plugins.android instanceof List
def plugins = object.plugins.android

plugins.each { plugin ->
    def pluginDirectory = flutterProjectRoot.resolve(plugin['path']).resolve('android').toFile()
    include ":${plugin['name']}"
    project(":${plugin['name']}").projectDir = pluginDirectory
}
